%!PS

/hypotrochoid 
{
    1 dict begin
        count 4 eq
        {

            /r exch def     % numberOfTimesAround
            /d exch def     % lengthOfArm
            /b exch def     % radiusOfSmallCircle
            /a exch def     % radiusOfBigCircle

            /middleX 8.5 2 div 72 mul def       % 72 is about an inch
            /middleY 11 2 div 72 mul def

            /i 0 def

            gsave

                newpath

                middleX middleY translate
                0 0 moveto

                360
                {
                    /t i r mul def

                    /x a b sub t cos mul d a b sub t mul b div cos mul add def
                    /y a b sub t sin mul d a b sub t mul b div sin mul sub def

                    i 0 eq 
                    {
                        x y moveto
                        x y lineto
                    }
                    {
                        x y lineto
                    }
                    ifelse
                    

                    /i i 1 add def
                }
                repeat

                stroke
                showpage
                
            grestore
        }
        {
            clear
        }
        ifelse
    end
} 
def
