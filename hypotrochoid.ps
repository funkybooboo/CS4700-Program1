%!PS

% Author: Nate Stott
% Date: Sep 6 2023
% Assignment 1 part 4/5 for Curtis Dyreson CS4700 USU 

% Use examples:

/hypotrochoid 
{
    1 dict begin
        count 4 eq
        {
            /r exch def     % numberOfTimesAround
            /d exch def     % lengthOfArm
            /b exch def     % radiusOfSmallCircle
            /a exch def     % radiusOfBigCircle

            /i 0 def
            gsave
                newpath
                    0 0 moveto
                    360
                    {
                        /t i r mul def
                        /x a b sub t cos mul d a b sub t mul b div cos mul add def
                        /y a b sub t sin mul d a b sub t mul b div sin mul sub def
                        i 0 eq 
                        {
                            x y moveto
                            x y lineto
                        }
                        {
                            x y lineto
                        }
                        ifelse
                        /i i 1 add def
                    }
                    repeat
                stroke
                showpage
            grestore
        }
        if
    end
} 
def