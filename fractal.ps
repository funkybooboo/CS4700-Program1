%!PS

% Author: Nate Stott
% Date: Sep 6 2023
% Assignment 1 part 5/5 for Curtis Dyreson CS4700 USU 

/fractal 
{ 
    count 1 eq
    {
        1 dict begin
            /num exch def
            num 1 ge
            {
                /startX 8.5 2 div 72 mul def       % 72 is about an inch
                /startY 11 2 div 72 mul def

                /tLength 72 2 mul def
                /tHight 72 2 mul def

                /tDraw
                {   
                    newpath
                        0 0 moveto
                        tLength 2 div neg tHight neg lineto
                        tLength 2 div tHight neg lineto
                        0 0 lineto
                        closepath
                    fill
                }
                def

                /decNum { /num num 1 sub def } def

                /tRight
                {
                    gsave
                        tLength 2 div tHight neg translate
                        .5 .5 scale
                        45 rotate
                        tDraw
                        num rFractal
                    grestore
                }
                def

                /tLeft
                {
                    gsave
                        tLength 2 div neg tHight neg translate
                        .5 .5 scale
                        -45 rotate
                        tDraw
                        num rFractal
                    grestore
                }
                def

                /rFractal
                {
                    count 1 eq
                    {
                        1 dict begin
                            /num exch def
                            decNum
                            num 1 ge
                            {
                                tRight
                                
                                tLeft
                            }
                            if
                        end
                    }
                    if
                }
                def

                gsave
                    1 0 0 setrgbcolor
                    startX startY translate

                    tDraw

                    num rFractal

                    showpage
                grestore
            }
            if
        end
    }
    if
} 
def